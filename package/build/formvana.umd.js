var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(t,e,i)=>e in t?__defProp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,__spreadValues=(t,e)=>{for(var i in e||(e={}))__hasOwnProp.call(e,i)&&__defNormalProp(t,i,e[i]);if(__getOwnPropSymbols)for(var i of __getOwnPropSymbols(e))__propIsEnum.call(e,i)&&__defNormalProp(t,i,e[i]);return t},__spreadProps=(t,e)=>__defProps(t,__getOwnPropDescs(e)),__accessCheck=(t,e,i)=>{if(!e.has(t))throw TypeError("Cannot "+i)},__privateGet=(t,e,i)=>(__accessCheck(t,e,"read from private field"),i?i.call(t):e.get(t)),__privateAdd=(t,e,i)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},__privateSet=(t,e,i,r)=>(__accessCheck(t,e,"write to private field"),r?r.call(t,i):e.set(t,i),i);!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["@formvana"]={})}(this,(function(t){var e,i,r,s,n,o,a,h,u;function l(){}function f(t){let e;return function(t,...e){if(null==t)return l;const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}(t,(t=>e=t))(),e}Promise.resolve();const c=[];function d(t,e=l){let i;const r=[];function s(e){if(n=e,((s=t)!=s?n==n:s!==n||s&&"object"==typeof s||"function"==typeof s)&&(t=e,i)){const e=!c.length;for(let i=0;i<r.length;i+=1){const e=r[i];e[1](),c.push(e,t)}if(e){for(let t=0;t<c.length;t+=2)c[t][0](c[t+1]);c.length=0}}var s,n}return{set:s,update:function(e){s(e(t))},subscribe:function(n,o=l){const a=[n,o];return r.push(a),1===r.length&&(i=e(s)||l),n(t),()=>{const t=r.indexOf(a);-1!==t&&r.splice(t,1),0===r.length&&(i(),i=null)}}}}class p{constructor(t,e){if(this.value=d(void 0),this.type="text",this.errors=d(void 0),this.clearErrors=()=>{this.errors.set(void 0)},this.clear=()=>{this.clearErrors()},this.addEventListener=(t,e)=>{if(!this.node)throw new Error("Node is missing! No Html Node to attach event listener too!");this.node.addEventListener(t,(t=>e instanceof Function?e(t):e),!1)},!t)throw new Error("{name: string} is required for FieldConfig intialization.");if(this.name=t,e&&Object.assign(this,e),!this.selector)throw new Error("Please pass in a valid Element.\nEither a string selector or a SvelteComponent.");this.value&&this.value.subscribe||(this.value=d(this.value)),this.attributes&&!this.attributes.type?this.attributes.type=this.type:this.attributes||(this.attributes={},this.attributes.type=this.type),!this.attributes["aria-label"]&&this.attributes.title?this.attributes["aria-label"]=this.attributes.title:this.attributes["aria-label"]||(this.attributes["aria-label"]=this.label||this.name)}}class _{constructor(t,e,i){t&&(this.field_key=t),e&&(this.errors=e),i&&Object.assign(this,i)}}class v{constructor(t,e=!1){if(this.blur=!0,this.change=!0,this.click=!1,this.dblclick=!1,this.focus=!0,this.input=!0,this.keydown=!1,this.keypress=!1,this.keyup=!1,this.mount=!1,this.mousedown=!1,this.mouseenter=!1,this.mouseleave=!1,this.mousemove=!1,this.mouseout=!1,this.mouseover=!1,this.mouseup=!1,this.submit=!0,e){let t;for(t in this)this[t]=!1}Object.assign(this,t)}}function y(t,e){return e.filter((e=>e.name===t))[0]}function m(t,e,i){let r=0,s=t.length;if(0===s)return;const n=e.map((t=>t.name));for(;s>r;++r){const s=n.indexOf(t[r]);if(-1!==s){b(n[s],e,i)}}}function b(t,e,i){const r=y(t,e);let s;for(s in i)"attributes"===s?Object.assign(r.attributes,i[s]):"name"!==s&&g(r,s,i[s])}function g(t,e,i){t[e]=i}function w(t,e){t.forEach((t=>{if(Array.isArray(t)){if((t=t[0]).field_key){y(t.field_key,e).errors.set(t)}}else if(t.field_key){y(t.field_key,e).errors.set(t)}}))}function E(t,e,i){e.forEach((e=>{const r=e.name,s=e.value;t?i[r]=f(s):s.set(i[r])}))}function k(t,e,i){const r=function(t){return t&&t.target?function(t){return isNaN(+t)||+t>=O?t:+t}(t.target.value):void 0}(i);e[t.name]=r,t.value.set(r)}const O=Number.MAX_SAFE_INTEGER;function P(t,e){const i=f(t);i[e.name]?(i[e.name]=f(e.value),t.set(__spreadValues({},i))):t.set(__spreadProps(__spreadValues({},i),{[e.name]:f(e.value)}))}function j(t,e){const i=f(t);i&&i!=={}&&Object.keys(i).length>0?e.set(!0):e.set(!1)}function A(t,e){return Object.assign(e.model,t.model),t.errors&&t.errors.length>0?e.errors=[...t.errors]:e.errors=[],e}function S(t,e,i,r,s){return t.pristine.set(!1),x([i&&"always"===t.validation_options.when_link_fields_to_model&&k(i,t.model,s),i&&P(t.value_changes,i),r&&M("before",r)]),t.validation_options.validator(t.model,t.validation_options.options).then((n=>(x([F(t,n,e,i,s),j(t.value_changes,t.changed),r&&M("after",r)]),n)))}function M(t,e){e&&e.length>0&&e.forEach((e=>{e.when===t&&T(e.callback)}))}function T(t){t instanceof Function&&t()}function x(t){Array.isArray(t)?t.forEach((t=>{T(t)})):T(t)}async function F(t,e,i,r,s){return e&&e.length>0?(t.errors=e,r?function(t,e){const i=t.filter((t=>t.field_key===e.name));i&&i.length>0?e.errors.set(i[0]):e.errors.set(void 0)}(e,r):w(e,t.fields),!function(t,e){if(0===t.length)return!0;let i=0,r=e.length;if(0===r)return!0;const s=t.map((t=>t.field_key));for(;r>i;++i)if(-1!==s.indexOf(e[i]))return!1;return!0}(e,i)?t.valid.set(!1):t.valid.set(!0)):(r&&"valid"===t.validation_options.when_link_fields_to_model&&k(r,t.model,s),t.clearErrors(),t.valid.set(!0)),e}function G(t,e,i,r,s){r&&r.when?e.addEventListener(i,S(t,s,void 0,[r])):e.addEventListener(i,r)}e=new WeakMap,i=new WeakMap;var C,R,I="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/*! *****************************************************************************
      Copyright (C) Microsoft. All rights reserved.
      Licensed under the Apache License, Version 2.0 (the "License"); you may not use
      this file except in compliance with the License. You may obtain a copy of the
      License at http://www.apache.org/licenses/LICENSE-2.0
  
      THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
      KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
      WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
      MERCHANTABLITY OR NON-INFRINGEMENT.
  
      See the Apache Version 2.0 License for specific language governing permissions
      and limitations under the License.
      ***************************************************************************** */R=C||(C={}),function(t){var e="object"==typeof I?I:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=r(R);function r(t,e){return function(i,r){"function"!=typeof t[i]&&Object.defineProperty(t,i,{configurable:!0,writable:!0,value:r}),e&&e(i,r)}}void 0===e.Reflect?e.Reflect=R:i=r(e.Reflect,i),function(t){var e=Object.prototype.hasOwnProperty,i="function"==typeof Symbol,r=i&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=i&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",n="function"==typeof Object.create,o={__proto__:[]}instanceof Array,a=!n&&!o,h={create:n?function(){return rt(Object.create(null))}:o?function(){return rt({__proto__:null})}:function(){return rt({})},has:a?function(t,i){return e.call(t,i)}:function(t,e){return e in t},get:a?function(t,i){return e.call(t,i)?t[i]:void 0}:function(t,e){return t[e]}},u=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,f=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?tt():Map,c=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?et():Set,d=new(l||"function"!=typeof WeakMap?it():WeakMap);function p(t,e,i,r){if(R(i)){if(!U(t))throw new TypeError;if(!$(e))throw new TypeError;return O(t,e)}if(!U(t))throw new TypeError;if(!W(e))throw new TypeError;if(!W(r)&&!R(r)&&!I(r))throw new TypeError;return I(r)&&(r=void 0),P(t,e,i=D(i),r)}function _(t,e){function i(i,r){if(!W(i))throw new TypeError;if(!R(r)&&!H(r))throw new TypeError;x(t,e,i,r)}return i}function v(t,e,i,r){if(!W(i))throw new TypeError;return R(r)||(r=D(r)),x(t,e,i,r)}function y(t,e,i){if(!W(e))throw new TypeError;return R(i)||(i=D(i)),A(t,e,i)}function m(t,e,i){if(!W(e))throw new TypeError;return R(i)||(i=D(i)),S(t,e,i)}function b(t,e,i){if(!W(e))throw new TypeError;return R(i)||(i=D(i)),M(t,e,i)}function g(t,e,i){if(!W(e))throw new TypeError;return R(i)||(i=D(i)),T(t,e,i)}function w(t,e){if(!W(t))throw new TypeError;return R(e)||(e=D(e)),F(t,e)}function E(t,e){if(!W(t))throw new TypeError;return R(e)||(e=D(e)),G(t,e)}function k(t,e,i){if(!W(e))throw new TypeError;R(i)||(i=D(i));var r=j(e,i,!1);if(R(r))return!1;if(!r.delete(t))return!1;if(r.size>0)return!0;var s=d.get(e);return s.delete(i),s.size>0||d.delete(e),!0}function O(t,e){for(var i=t.length-1;i>=0;--i){var r=(0,t[i])(e);if(!R(r)&&!I(r)){if(!$(r))throw new TypeError;e=r}}return e}function P(t,e,i,r){for(var s=t.length-1;s>=0;--s){var n=(0,t[s])(e,i,r);if(!R(n)&&!I(n)){if(!W(n))throw new TypeError;r=n}}return r}function j(t,e,i){var r=d.get(t);if(R(r)){if(!i)return;r=new f,d.set(t,r)}var s=r.get(e);if(R(s)){if(!i)return;s=new f,r.set(e,s)}return s}function A(t,e,i){if(S(t,e,i))return!0;var r=Z(e);return!I(r)&&A(t,r,i)}function S(t,e,i){var r=j(e,i,!1);return!R(r)&&K(r.has(t))}function M(t,e,i){if(S(t,e,i))return T(t,e,i);var r=Z(e);return I(r)?void 0:M(t,r,i)}function T(t,e,i){var r=j(e,i,!1);if(!R(r))return r.get(t)}function x(t,e,i,r){j(i,r,!0).set(t,e)}function F(t,e){var i=G(t,e),r=Z(t);if(null===r)return i;var s=F(r,e);if(s.length<=0)return i;if(i.length<=0)return s;for(var n=new c,o=[],a=0,h=i;a<h.length;a++){var u=h[a];n.has(u)||(n.add(u),o.push(u))}for(var l=0,f=s;l<f.length;l++)u=f[l],n.has(u)||(n.add(u),o.push(u));return o}function G(t,e){var i=[],r=j(t,e,!1);if(R(r))return i;for(var s=Y(r.keys()),n=0;;){var o=J(s);if(!o)return i.length=n,i;var a=B(o);try{i[n]=a}catch(h){try{Q(s)}finally{throw h}}n++}}function C(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function R(t){return void 0===t}function I(t){return null===t}function L(t){return"symbol"==typeof t}function W(t){return"object"==typeof t?null!==t:"function"==typeof t}function N(t,e){switch(C(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var i=3===e?"string":5===e?"number":"default",s=X(t,r);if(void 0!==s){var n=s.call(t,i);if(W(n))throw new TypeError;return n}return V(t,"default"===i?"number":i)}function V(t,e){if("string"===e){var i=t.toString;if(q(i)&&!W(s=i.call(t)))return s;if(q(r=t.valueOf)&&!W(s=r.call(t)))return s}else{var r;if(q(r=t.valueOf)&&!W(s=r.call(t)))return s;var s,n=t.toString;if(q(n)&&!W(s=n.call(t)))return s}throw new TypeError}function K(t){return!!t}function z(t){return""+t}function D(t){var e=N(t,3);return L(e)?e:z(e)}function U(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function q(t){return"function"==typeof t}function $(t){return"function"==typeof t}function H(t){switch(C(t)){case 3:case 4:return!0;default:return!1}}function X(t,e){var i=t[e];if(null!=i){if(!q(i))throw new TypeError;return i}}function Y(t){var e=X(t,s);if(!q(e))throw new TypeError;var i=e.call(t);if(!W(i))throw new TypeError;return i}function B(t){return t.value}function J(t){var e=t.next();return!e.done&&e}function Q(t){var e=t.return;e&&e.call(t)}function Z(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===u)return e;if(e!==u)return e;var i=t.prototype,r=i&&Object.getPrototypeOf(i);if(null==r||r===Object.prototype)return e;var s=r.constructor;return"function"!=typeof s||s===t?e:s}function tt(){var t={},e=[],i=function(){function t(t,e,i){this._index=0,this._keys=t,this._values=e,this._selector=i}return t.prototype["@@iterator"]=function(){return this},t.prototype[s]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var i=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:i,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var i=this._find(t,!0);return this._values[i]=e,this},e.prototype.delete=function(e){var i=this._find(e,!1);if(i>=0){for(var r=this._keys.length,s=i+1;s<r;s++)this._keys[s-1]=this._keys[s],this._values[s-1]=this._values[s];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new i(this._keys,this._values,r)},e.prototype.values=function(){return new i(this._keys,this._values,n)},e.prototype.entries=function(){return new i(this._keys,this._values,o)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[s]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function r(t,e){return t}function n(t,e){return e}function o(t,e){return[t,e]}}function et(){return function(){function t(){this._map=new f}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[s]=function(){return this.keys()},t}()}function it(){var t=16,i=h.create(),r=s();return function(){function t(){this._key=s()}return t.prototype.has=function(t){var e=n(t,!1);return void 0!==e&&h.has(e,this._key)},t.prototype.get=function(t){var e=n(t,!1);return void 0!==e?h.get(e,this._key):void 0},t.prototype.set=function(t,e){return n(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=n(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=s()},t}();function s(){var t;do{t="@@WeakMap@@"+u()}while(h.has(i,t));return i[t]=!0,t}function n(t,i){if(!e.call(t,r)){if(!i)return;Object.defineProperty(t,r,{value:h.create()})}return t[r]}function o(t,e){for(var i=0;i<e;++i)t[i]=255*Math.random()|0;return t}function a(t){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):o(new Uint8Array(t),t):o(new Array(t),t)}function u(){var e=a(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var i="",r=0;r<t;++r){var s=e[r];4!==r&&6!==r&&8!==r||(i+="-"),s<16&&(i+="0"),i+=s.toString(16).toLowerCase()}return i}}function rt(t){return t.__=void 0,delete t.__,t}t("decorate",p),t("metadata",_),t("defineMetadata",v),t("hasMetadata",y),t("hasOwnMetadata",m),t("getMetadata",b),t("getOwnMetadata",g),t("getMetadataKeys",w),t("getOwnMetadataKeys",E),t("deleteMetadata",k)}(i)}();class L{constructor(t,e){__privateAdd(this,r,void 0),__privateAdd(this,s,void 0),__privateAdd(this,n,void 0),__privateAdd(this,o,void 0),__privateAdd(this,a,void 0),__privateAdd(this,h,void 0),__privateAdd(this,u,void 0),this.forms=[],this.loading=d(!1),this.all_value_changes=d({}),this.all_valid=d(!1),this.any_changed=d(!1),this.all_pristine=d(!1),__privateSet(this,r,{}),__privateSet(this,s,{}),__privateSet(this,n,{}),this._subscriptions=[],this.validateAll=(t,e)=>{if(e)e.forEach((e=>{this.forms&&this.forms[e].validate(t)}));else{let e;for(e in this.forms)this.forms[e].validate(t)}},this.destroy=()=>{this.forms.forEach((t=>t.destroy()))},this.destroySubscriptions=()=>{this._subscriptions&&this._subscriptions.length>0&&this._subscriptions.forEach((t=>t()))},this.resetAll=()=>{this.forms.forEach((t=>t.reset()))},__privateSet(this,o,(()=>{let t,e=0;for(t in this.forms){const i=`form_${e}`;if("{}"!=`${f(this.forms[t].value_changes)}`){const e=f(this.all_value_changes);e[i]||this.all_value_changes.set(__spreadProps(__spreadValues({},e),{[i]:{}}));const r=this.forms[t].value_changes.subscribe((t=>{const e=f(this.all_value_changes);this.all_value_changes.set(__spreadProps(__spreadValues({},e),{[i]:t}))}));this._subscriptions.push(r)}e++}})),__privateSet(this,a,(()=>{let t,e=0;for(t in this.forms){const i=e,s=this.forms[t].valid.subscribe((t=>{__privateGet(this,r)[i]=t,Object.values(__privateGet(this,r)).includes(!1)?this.all_valid.set(!1):this.all_valid.set(!0)}));this._subscriptions.push(s),e++}})),__privateSet(this,h,(()=>{let t,e=0;for(t in this.forms){const i=e,r=this.forms[t].changed.subscribe((t=>{__privateGet(this,s)[i]=t,Object.values(__privateGet(this,s)).includes(!0)?this.any_changed.set(!0):this.any_changed.set(!1)}));this._subscriptions.push(r),e++}})),__privateSet(this,u,(()=>{let t,e=0;for(t in this.forms){const i=e,r=this.forms[t].pristine.subscribe((t=>{__privateGet(this,n)[i]=t,Object.values(__privateGet(this,n)).includes(!1)?this.all_pristine.set(!1):this.all_pristine.set(!0)}));this._subscriptions.push(r),e++}})),t&&(this.forms=t),e&&Object.assign(this,e),__privateGet(this,o).call(this),__privateGet(this,a).call(this),__privateGet(this,h).call(this),__privateGet(this,u).call(this)}}r=new WeakMap,s=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,h=new WeakMap,u=new WeakMap;t.FieldConfig=p,t.FieldStepper=class{constructor(t,e){if(this.fields=t,e)this.active_step=e;else{let e;for(e in t)this.active_step=e}}get fields_valid(){let t,e=!0;for(t in this.fields)f(this.fields[t].errors)&&(e=!1);return d(e)}},t.Form=class{constructor(t,r,s){if(__privateAdd(this,e,void 0),__privateAdd(this,i,void 0),this.fields=[],this.errors=[],this.validation_options={validator:async()=>[],on_events:new v,when_link_fields_to_model:"always"},this.valid=d(!1),this.changed=d(!1),this.pristine=d(!0),this.loading=d(!1),this.value_changes=d({}),this.initial_state={model:{},errors:void 0},__privateSet(this,i,[]),this.buildFields=(t=this.model)=>{this.field_schema?this.fields=function(t,e){let i,r=[];for(i in t){const e=new p(i,__spreadValues({},t[i]));r.push(e)}return e&&r.filter((t=>e.name===t.for_form)),r}(this.field_schema,this.meta):this.fields=function(t,e,i=Reflect.getMetadata("editableProperties",t)){const r=i.map((e=>new p(e,__spreadProps(__spreadValues({},Reflect.getMetadata("fieldConfig",t,e)),{value:t[e]}))));return e&&r.filter((t=>e.name===t.for_form)),r}(t,this.meta),__privateSet(this,i,this.fields.filter((t=>t.required)).map((t=>t.name)))},this.useForm=t=>{let e;for(e in this.model){const i=t.querySelectorAll(`[name="${e}"]`);if(i&&i[0]){const t=i[0];this.useField(t)}}},this.useField=t=>{const e=y(t.name,this.fields);e.node=t,this.validation_options.on_events&&function(t,e,i){Object.entries(e).forEach((([e,r])=>{var s,n;r&&("SELECT"===(null==(s=t.node)?void 0:s.nodeName)&&"input"!==e&&t.addEventListener(e,i),"SELECT"!==(null==(n=t.node)?void 0:n.nodeName)&&t.addEventListener(e,i))}))}(e,this.validation_options.on_events,(t=>S(this,__privateGet(this,i),e,void 0,t)))},this.validate=t=>S(this,__privateGet(this,i),void 0,t),this.validateField=(t,e,r)=>{const s=y(t,this.fields);if(e){const i=new _(t,{error:e},{value:f(s.value)});this.errors.push(i),w(this.errors,this.fields)}else S(this,__privateGet(this,i),s,r)},this.attachCallbacks=(t,e,r)=>{if(Array.isArray(r)){r.map((t=>y(t,this.fields))).forEach((r=>{G(this,r,t,e,__privateGet(this,i))}))}else{G(this,y(r,this.fields),t,e,__privateGet(this,i))}},this.clearErrors=()=>{this.errors=[],this.fields.forEach((t=>{t.errors.set(void 0)}))},this.get=t=>y(t,this.fields),this.loadModel=(t,e=!1,i=!1)=>{if(e)this.model=t,this.buildFields();else{let e;for(e in this.model)this.model[e]=t[e];E(!1,this.fields,this.model)}return i&&this.updateInitialState(),this},this.setValue=(t,e)=>{if(Array.isArray(t))t.forEach((t=>{y(t,this.fields).value.set(e),this.model[t]=e}));else{y(t,this.fields).value.set(e),this.model[t]=e}},this.attachReferenceData=t=>{const e=this.fields.filter((t=>t.ref_key));t?(this.refs=t,e.forEach((e=>{e.ref_key&&(e.options=t[e.ref_key])}))):this.refs&&e.forEach((t=>{t.ref_key&&this.refs&&(t.options=this.refs[t.ref_key])}))},this.destroy=()=>{this.fields&&this.fields.length>0&&this.fields.forEach((t=>{this.validation_options.on_events&&Object.keys(this.validation_options.on_events).forEach((e=>{t.node&&t.node.removeEventListener(e,(t=>{}))}))}))},this.reset=()=>{var t,e;t=this,e=this.initial_state,Object.assign(t.model,e.model),t.clearErrors(),e.errors&&e.errors.length>0?t.errors=[...e.errors]:t.errors=[],E(!1,t.fields,t.model),t.errors&&t.errors.length>0&&w(t.errors,t.fields),t.value_changes.set({}),t.changed.set(!1)},this.updateInitialState=()=>{A(this,this.initial_state),this.changed.set(!1)},this.setFieldOrder=t=>{t&&t.length>0&&(__privateSet(this,e,t),this.fields=function(t,e){let i=[],r=[];return t.forEach((s=>{const n=y(s,e);n.name===s?i.push(n):-1===r.indexOf(n)&&-1===t.indexOf(n.name)&&r.push(n)})),e=[...i,...r]}(__privateGet(this,e),this.fields))},this.setFieldAttributes=(t,e)=>{t&&(Array.isArray(t)?m(t,this.fields,e):m([t],this.fields,e))},s&&Object.assign(this,s),!t)throw new Error("Model is not valid. Please use a valid model.");if(this.model=t,!r)throw new Error("Please add a validator with ReturnType<Promise<ValidationError[]>>");Object.assign(this.validation_options,r),this.buildFields(),this.refs&&this.attachReferenceData(),this.disabled_fields&&m(this.disabled_fields,this.fields,{disabled:!0,attributes:{disabled:!0}}),this.hidden_fields&&m(this.hidden_fields,this.fields,{hidden:!0}),A(this,this.initial_state)}},t.FormGroup=class extends L{constructor(t,e){super(t,e)}},t.FormManager=L,t.FormStepper=class extends L{constructor(t,e){super(t,e),this.active_step=0,this.next=()=>{"number"==typeof this.active_step&&this.active_step++},this.back=()=>{"number"==typeof this.active_step&&this.active_step--}}},t.OnEvents=v,t.ValidationError=_,t.field=function(t){return function(e,i){let r=Reflect.getMetadata("editableProperties",e)||[];r.indexOf(i)<0&&r.push(i),Reflect.defineMetadata("editableProperties",r,e),Reflect.defineMetadata("fieldConfig",t,e,i)}},Object.defineProperty(t,"__esModule",{value:!0}),t[Symbol.toStringTag]="Module"}));
